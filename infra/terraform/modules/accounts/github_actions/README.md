### PGP(Pretty Good Privacy)キーの作成
 - IAMユーザー作成時にアクセスキー(アクセスキーID、シークレットアクセスキー)を生成するが、その際にpgpの公開鍵が必要になる
 - ただ、生成されるシークレットアクセスキーは、ログやステートファイルに暗号化された状態で出力されるため、暗号化されたシークレットアクセスキーを復号化する秘密鍵が必要

#### キーの作成
 - GPG(GNU Privacy Guard)を使用
   - PGPのフリーのオープンソースの1つであり、PGPの原理と概念を基にして作成されており、互換性がある
 - GPGで作成したキーは、PGP互換のシステムやプロトコルで使用することが可能
 - キー生成コマンド
     ```
    gpg --full-generate-key
    ```
   - キー生成時、下記が求められる
     - 公開鍵暗号方式
     - ビット数
     - 有効期限
     - 氏名
     - メールアドレス
     - コメント
     - パスフレーズ
 - `Base64`でエンコードしたものを公開鍵として使用


#### 公開キーをエクスポートし、Base64にエンコード
 - 公開キーをエンコードしたものをTerraformで使用する

    ```
    gpg -o ./.public.gpg --export <生成時に使用したメールアドレス>
    cat ./.public.gpg | base64 | tr -d '\n' > .public.gpg.base64
    ```

#### 秘密キーのエクスポート
 - 生成されたシークレットアクセスキーを復号する際に使用する
 - 秘密キーは実際にはエクスポートは不要
    ```
    gpg -o ./.private.gpg --export-secret-key <生成時に使用したメールアドレス>
    ```

#### シークレットアクセスキーを復号
 - パスフレーズを入力するプロンプトを表示するためにまずは環境変数を設定する

    ```
    export GPG_TTY=$(tty)
    ```

    ```
    terraform output -json global | jq -r '.secret_access_key'  | base64 -d | gpg -r <生成時に使用したメールアドレス> --decrypt
    ```

#### 公開鍵と秘密鍵の一覧を表示
```
gpg --list-keys
gpg --list-secret-keys
```
